{"version":3,"file":"js/445.7419eba6.js","mappings":"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","sources":["webpack://moric-app/./src/store/ImageProcessingModule.js","webpack://moric-app/./src/components/MoricAppNavation.vue","webpack://moric-app/./src/components/MoricAppNavation.vue?05c2","webpack://moric-app/./src/pages/MoricHome/components/MoricMsg/MoricUserList.vue","webpack://moric-app/./src/pages/MoricHome/components/MoricMsg/components/MoricUserListItem.vue","webpack://moric-app/./src/pages/MoricHome/components/MoricMsg/components/MoricUserListItem.vue?4b84","webpack://moric-app/./src/pages/MoricHome/components/MoricMsg/components/MoricSearchInput.vue","webpack://moric-app/./src/pages/MoricHome/components/MoricMsg/components/MoricSearchInput.vue?5fc2","webpack://moric-app/./src/pages/MoricHome/components/MoricMsg/components/MoricGroupItem.vue","webpack://moric-app/./src/pages/MoricHome/components/MoricMsg/components/MoricGroupItem.vue?969a","webpack://moric-app/./src/directives/animateDirective.js","webpack://moric-app/./src/pages/MoricHome/components/MoricMsg/MoricUserList.vue?c883"],"sourcesContent":["import {defineStore} from 'pinia'\r\nimport axios from \"@/plugins/axiosInstance\";\r\n\r\nexport const useimgCounterStore = defineStore('imgCounter',{\r\n    //数据保存\r\n    state(){\r\n        return{\r\n            imageList:new Map(),\r\n        }\r\n    },\r\n    actions:{\r\n        //请求图片管理\r\n        async requestImage(user_id,avatar_type){\r\n            //仓库是否有用户头像\r\n            if(this.imageList.has(user_id)){\r\n                return this.getPicture(user_id);\r\n            }\r\n            //否则请求服务器用户头像\r\n            return new Promise((resolve,reject)=>{\r\n                axios({\r\n                    url:`/moric/avatar`,\r\n                    method:\"post\",\r\n                    data:{\r\n                        user_id,\r\n                    }\r\n                }).then((values)=>{\r\n                    if(!values.data.body){\r\n                        return;\r\n                    }\r\n                    this.savePicture(values.data.body,user_id,avatar_type);\r\n                    resolve(this.getPicture(user_id));\r\n                }).catch((err)=>{\r\n                    console.log(err);\r\n                    reject(\"失败\");\r\n                });\r\n            });\r\n        },\r\n        //缓存图片\r\n        savePicture(imgData,user_id,avatar_type){\r\n            let blob = null;\r\n            if(/^data:.*;base64,/.test(imgData)){\r\n                //将base图片转为二进制图片\r\n                const byteCharacters = atob(imgData.split(',')[1]);\r\n                const byteNumbers = new Array(byteCharacters.length);\r\n                for (let i = 0; i < byteCharacters.length; i++) {\r\n                    byteNumbers[i] = byteCharacters.charCodeAt(i);\r\n                }\r\n                blob = new Blob([new Uint8Array(byteNumbers)], {type: `image/${avatar_type}`});\r\n            }else{\r\n                // 假设 imgData 为 JPG 图片的二进制数据\r\n                blob = new Blob([imgData], { type: `image/${avatar_type}` });\r\n            } \r\n            this.imageList.set(user_id,blob);\r\n        },\r\n        //返回图片url\r\n        getPicture(user_id){\r\n            let imageUrl = null;\r\n            if(this.imageList.get(user_id)){\r\n                // imageUrl = URL.createObjectURL(imageList.get(user_id));\r\n                imageUrl = window.URL.createObjectURL(this.imageList.get(user_id));\r\n            }\r\n            // 生成图片的url地址\r\n            return imageUrl;\r\n        },\r\n        //清除缓存图片\r\n        clearImages(){\r\n            for (const [user_id, blob] of imageList.entries()){\r\n                URL.revokeObjectURL(blob);\r\n                this.imageList.delete(user_id);\r\n            }\r\n        }\r\n    }\r\n});","<template>\r\n    <div class=\"topNavigation\">\r\n        <div class=\"topLeft\">\r\n            <a @click.stop=\"goTo\" class=\"black\">\r\n                <div class=\"blackIcon\"></div>\r\n            </a>\r\n            <div class=\"stateMsg\">\r\n                {{name}}\r\n            </div>\r\n        </div>\r\n        <div class=\"appLogo\">\r\n            <div class=\"appIcon\">Moric</div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {useRouter} from 'vue-router'\r\nimport pubsub from \"pubsub-js\"\r\nimport { useCounterStore } from '@/store/index'\r\nimport { useChatRecordCounterStore } from '@/controllers/chatObjController'\r\nexport default {\r\n    name:\"MoricAppNavation\",\r\n    props:[\"name\",\"msg\"],\r\n    setup(props){\r\n        const router = useRouter();\r\n        const chatRecordList = useChatRecordCounterStore();\r\n        //发布消息\r\n        function goTo(){\r\n            //清除所有内容\r\n            const userList = useCounterStore();\r\n            userList.clearUserList();\r\n            userList.$reset();\r\n            chatRecordList.$reset();\r\n            pubsub.publish(\"clearUserList\");\r\n            pubsub.publish(\"scoketDisconnect\");\r\n            router.replace({\r\n                name:props.msg.name,\r\n                path:props.msg.path,\r\n            });\r\n        }\r\n        return {\r\n            goTo\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n    *{\r\n        font-family: 'icomoon';\r\n    }\r\n    a{\r\n        text-decoration: none;\r\n        color:#052630;\r\n    }\r\n    .topNavigation{\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        right: 0;\r\n        padding: 12px 24px 5px 24px;\r\n        width: 100%;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        z-index: 10;\r\n        background: #ffffff;\r\n    }\r\n    @media(min-width: 600pt){\r\n        .topNavigation{\r\n            position: fixed;\r\n            top: 0;\r\n            left: 50%;\r\n            transform: translateX(-50%);\r\n            right: 0;\r\n            padding: 0 24px;\r\n            width: 70%;\r\n            height: 30pt;\r\n            display: flex;\r\n            justify-content: space-between;\r\n            align-items: center;\r\n            background: #ffffff;\r\n        }\r\n    }\r\n    .topLeft{\r\n        min-width: 40%;\r\n        height: 100%;\r\n        display: grid;\r\n        grid-template-columns: max-content max-content;\r\n        align-items: center;\r\n        gap: 10px;\r\n        cursor: hand;\r\n    }\r\n    .black{\r\n        cursor:pointer;\r\n    }\r\n    .blackIcon{\r\n        font-weight: 600;\r\n        font-size: 17pt;\r\n    }\r\n    .stateMsg{\r\n        font-weight: 400;\r\n        font-size: 15pt;\r\n    }\r\n    .appLogo{\r\n        min-width: max-content;\r\n        height: 100%;\r\n        display: flex;\r\n        align-items: center;\r\n    }\r\n    .appIcon{\r\n        font-family: \"Luckiest\";\r\n        width: 100%;\r\n        font-size: 22pt;\r\n    }\r\n</style>","import { render } from \"./MoricAppNavation.vue?vue&type=template&id=25b78108\"\nimport script from \"./MoricAppNavation.vue?vue&type=script&lang=js\"\nexport * from \"./MoricAppNavation.vue?vue&type=script&lang=js\"\n\nimport \"./MoricAppNavation.vue?vue&type=style&index=0&id=25b78108&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div class=\"MoricUserList\">\r\n        <MoricAppNavation :name=\"homeMsg.name\" :msg=\"homeMsg.msg\"></MoricAppNavation>\r\n        <div class=\"bottom\">\r\n            <MoricSearchInput/>\r\n            <ul class=\"content\">\r\n                <li>\r\n                    <MoricGroupItem/>\r\n                </li>\r\n                <template v-if=\"userListArray.length\">\r\n                    <li \r\n                    v-animate\r\n                    v-for=\"(user,index) in userListArray\" \r\n                    :key=\"user.user_id\" \r\n                    :index=\"index\">\r\n                        <MoricUserListItem :item=\"user\"/>\r\n                    </li>\r\n                </template>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport MoricAppNavation from '@/components/MoricAppNavation.vue';\r\nimport MoricUserListItem from './components/MoricUserListItem.vue';\r\nimport MoricSearchInput from './components/MoricSearchInput.vue';\r\nimport MoricGroupItem from './components/MoricGroupItem.vue';\r\nimport animateDirective from '@/directives/animateDirective'\r\nimport { useCounterStore } from '@/store';\r\nimport { reactive, computed } from 'vue'\r\nexport default {\r\n    name:\"MoricUserList\",\r\n    components:{\r\n        MoricAppNavation,\r\n        MoricUserListItem,\r\n        MoricSearchInput,\r\n        MoricGroupItem\r\n    },\r\n    setup(){\r\n        //当前页面信息\r\n        let homeMsg = reactive({\r\n            name:\"消息\",\r\n            msg:{\r\n                name:\"MoricLogin\",\r\n                path:\"/\"\r\n            },\r\n            mySelfLoaded:false,\r\n        });\r\n        //获取用户列表\r\n        //初始化用户信息管理模块\r\n        const userStore = useCounterStore();\r\n        const userListArray = computed(() => userStore.userListArray);\r\n\r\n        return{\r\n            homeMsg,\r\n            userListArray\r\n        }\r\n    },\r\n    directives: {\r\n        // 在模板中启用 v-focus\r\n        animate: animateDirective\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n    .bottom{\r\n        padding: 30pt 0;\r\n    }\r\n    .content{\r\n        width: 100%;\r\n        margin-top: 20px;\r\n        display: grid;\r\n        grid-auto-rows: 1fr;\r\n        align-content: center;\r\n    }\r\n    .content li{\r\n        transition:all .4s;\r\n    }\r\n</style>","<template>\r\n    <div class=\"MoricUserListItem\"\r\n        v-listLoding \r\n        @touchstart.stop.passive=\"toggleClass\" \r\n        @touchend.stop.passive=\"toggleClass\"\r\n        @click.stop=\"jump\"\r\n        :class=\"active\">\r\n        <div class=\"avatar loading\">\r\n            <img :src=\"imgNode.data\" v-if=\"imgNode.data\" alt=\"头像\" class=\"avatarImage\">\r\n            <div v-else class=\"defaultAvatar\">\r\n                \r\n            </div>\r\n        </div>\r\n        <div class=\"establishChat\">\r\n            <div class=\"establishChat_left\">\r\n                <div class=\"userName\">\r\n                    {{user.name}}\r\n                </div>\r\n                <div class=\"msgData\">\r\n                    {{user.lastMsg}}\r\n                </div>\r\n            </div>\r\n            <div class=\"establishChat_right\">\r\n                <div class=\"msgDeta\">\r\n                    {{user.timing}}\r\n                </div>\r\n                <div class=\"unread\">\r\n                    <i class=\"unreadData\" v-if=\"user.unreadMessage\">\r\n                        {{user.unreadMessage}}\r\n                    </i>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { reactive, ref } from 'vue'\r\nimport { useRouter } from 'vue-router';\r\nimport {useimgCounterStore} from \"@/store/ImageProcessingModule\";\r\nimport { useChatRecordCounterStore } from \"@/controllers/chatObjController\";\r\nexport default {\r\n    props:[\"item\"],\r\n    setup(props){\r\n        //聊天记录\r\n        const ChatRecordList = useChatRecordCounterStore();\r\n        let {item} = props;\r\n        const router = useRouter();\r\n        let imgNode = reactive({\r\n            data:null,\r\n        });\r\n        let active = ref({\r\n            \"active\":false\r\n        })\r\n        const imgStore = useimgCounterStore();\r\n        if(item.user_id){\r\n            imgStore.requestImage(item.user_id,item.avatar_type).then((data)=>{\r\n                imgNode.data = data;\r\n            },(err)=>{\r\n                console.log(err);\r\n            })\r\n        }\r\n        let user = reactive({\r\n            name:null,\r\n            lastMsg:null,\r\n            timing:null,\r\n            unreadMessage:0\r\n        });\r\n        if(item){\r\n            user.name = item.username;\r\n            user.lastMsg = item.lastMsg;\r\n            user.timing = item.timing;\r\n        }\r\n        //触摸事件\r\n        function toggleClass(){\r\n            active.value = true;\r\n        }\r\n        //跳转\r\n        function jump(){\r\n            router.push({\r\n                name:'MoricChatInterface',\r\n                query:{\r\n                    chat_name:user.name,\r\n                    chat_id:item.user_id\r\n                }\r\n            });\r\n        }\r\n        //创建聊天历史仓库\r\n        //跳转到这个页面时候主动获取最后一条消息\r\n        Promise.resolve(ChatRecordList.createChatList(item.user_id)).then(()=>{\r\n            const arr = ChatRecordList.getChatRecordLastMessage(item.user_id);\r\n            if(arr){\r\n                user.lastMsg = arr.messageData;\r\n                user.timing = arr.timeing;\r\n            }\r\n        });\r\n        //未读消息，被动接收消息\r\n        PubSub.subscribe(`${item.user_id}`,( _ , updatedMsg)=>{\r\n            //未读消息+1\r\n            user.unreadMessage ++;\r\n            //更新最后一条消息\r\n            user.lastMsg = updatedMsg.messageData;\r\n            //更新最后更新的时间\r\n            user.timing = updatedMsg.timeing;\r\n        });\r\n\r\n        return{\r\n            imgNode,\r\n            user,\r\n            active,\r\n            jump,\r\n            toggleClass\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n    .MoricUserListItem{\r\n        width: 100%;\r\n        /* height: 40pt; */\r\n        padding: 12px 24px;\r\n        display: grid;\r\n        grid-template-columns: 40pt 1fr;\r\n        grid-template-rows: 1fr;\r\n        cursor: pointer;\r\n    }\r\n    .MoricUserListItem:active{\r\n        background: #f0eff2;\r\n    }\r\n    .active{\r\n        background: #f0eff2;\r\n    }\r\n    @media(min-width: 600pt){\r\n        .MoricUserListItem:hover{\r\n            background: #f0eff2;\r\n        }\r\n        .MoricUserListItem:active{\r\n            background:none;\r\n        }\r\n    }\r\n    .avatar{\r\n        width: 40pt;\r\n        height: 40pt;\r\n        border-radius: 50%;\r\n        overflow: hidden;\r\n    }\r\n    .avatarImage{\r\n        width: 100%;\r\n        height: 100%;\r\n        border-radius: 50%;\r\n        object-fit: cover;\r\n    }\r\n    .defaultAvatar{\r\n        width: 100%;\r\n        height: 100%;\r\n        display: flex;\r\n        border-radius: 50%;\r\n        justify-content: center;\r\n        align-items: center;\r\n        background: #f0eff2;\r\n        color: #151819;\r\n        font-size: 30pt;\r\n    }\r\n    .establishChat{\r\n        width: 100%;\r\n        height: 100%;\r\n        display: grid;\r\n        grid-template-columns: 1fr 30pt;\r\n        /* margin-left: 10pt; */\r\n    }\r\n    .establishChat_left{\r\n        display: flex;\r\n        padding: 0 0 0 10px;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        overflow: hidden;\r\n    }\r\n    .establishChat_left div{\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n    }\r\n    .userName{\r\n        font-size: 16pt;\r\n    }\r\n    .establishChat_right{\r\n        text-align: right;\r\n        display: grid;\r\n    }\r\n    .msgData{\r\n        margin-top: 2px;\r\n        font-size: 10pt;\r\n        font-weight: 400;\r\n        color: #8f8e93;\r\n    }\r\n    .msgDeta{\r\n        font-size: 10pt;\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n    .unread{\r\n        font-size: 10pt;\r\n        width: 100%;\r\n        height: 100%;\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        align-items: center;\r\n    }\r\n    .unreadData{\r\n        font-style: normal;\r\n        width: 12pt;\r\n        height: 12pt;\r\n        display: flex;\r\n        font-size: 8pt;\r\n        justify-content: center;\r\n        align-items: center;\r\n        border-radius: 50%;\r\n        padding: 5px;\r\n        background: #fc3d39;\r\n        color: #ffffff;\r\n    }\r\n    .loading{\r\n        background: linear-gradient(110deg,\r\n        rgba(255,255,255, 0) 40%,\r\n        rgba(255,255,255,.5) 50%,\r\n        rgba(255,255,255,0) 60%) #d9d9d9;\r\n        background-size: 200% 100%;\r\n        background-position-x: 120%;\r\n        overflow: hidden;\r\n        animation: 1s loading ease-in-out infinite;\r\n    }\r\n    @keyframes loading{\r\n        to{\r\n            background-position-x: -20%;\r\n        }\r\n    }\r\n</style>","import { render } from \"./MoricUserListItem.vue?vue&type=template&id=64928705&scoped=true\"\nimport script from \"./MoricUserListItem.vue?vue&type=script&lang=js\"\nexport * from \"./MoricUserListItem.vue?vue&type=script&lang=js\"\n\nimport \"./MoricUserListItem.vue?vue&type=style&index=0&id=64928705&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-64928705\"]])\n\nexport default __exports__","<template>\r\n    <div class=\"MoricSearchInput\">\r\n          <input type=\"text\" title=\"search\" placeholder=\" 好友\">\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  export default {\r\n      name:\"MoricSearchInput\",\r\n  }\r\n  </script>\r\n  \r\n  <style scoped> \r\n      *{\r\n          font-family: 'icomoon';\r\n      }\r\n      .MoricSearchInput{\r\n          width: 100%;\r\n          height: 28pt;\r\n          margin: 5px 0;\r\n          padding: 0 24px;\r\n      }\r\n      .MoricSearchInput input{\r\n          display: flex;\r\n          align-items: center;\r\n          width: 100%;\r\n          height: 100%;\r\n          font-size: 12pt;\r\n          outline: none;\r\n          border: none;\r\n          /* color: #d2d0da; */\r\n          background-color: #f0eff4;\r\n          border-radius: 10px;\r\n          text-indent: 1em;\r\n      }\r\n  </style>","import { render } from \"./MoricSearchInput.vue?vue&type=template&id=e82406da&scoped=true\"\nimport script from \"./MoricSearchInput.vue?vue&type=script&lang=js\"\nexport * from \"./MoricSearchInput.vue?vue&type=script&lang=js\"\n\nimport \"./MoricSearchInput.vue?vue&type=style&index=0&id=e82406da&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-e82406da\"]])\n\nexport default __exports__","<template>\r\n    <div class=\"MoricUserListItem\" \r\n        @touchstart.stop.passive=\"toggleClass\" \r\n        @touchend.stop.passive=\"toggleClass\"\r\n        @click.stop=\"jump\"\r\n        :class=\"active\">\r\n        <div class=\"avatar\">\r\n            \r\n        </div>\r\n        <div class=\"establishChat\">\r\n            <div class=\"establishChat_left\">\r\n                <div class=\"userName\">\r\n                    {{user.username}}\r\n                </div>\r\n                <div class=\"msgData\">\r\n                    {{user.lastMsg}}\r\n                </div>\r\n            </div>\r\n            <div class=\"establishChat_right\">\r\n                <div class=\"msgDeta\">\r\n                    {{user.timing}}\r\n                </div>\r\n                <div class=\"unread\">\r\n                    <i class=\"unreadData\" v-if=\"unread\">\r\n                        {{ unread }}\r\n                    </i>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { reactive, ref } from 'vue'\r\nimport { useRouter } from 'vue-router';\r\nimport { useChatRecordCounterStore } from '@/controllers/chatObjController';\r\nimport PubSub from 'pubsub-js';\r\nimport { useGroupChatRecordStore } from '@/controllers/groupChatController'\r\n\r\nexport default {\r\n    setup(){\r\n        //聊天记录\r\n        const ChatRecordList = useChatRecordCounterStore();\r\n        let active = ref({\r\n            \"active\":false\r\n        });\r\n        //群聊信息\r\n        const group = useGroupChatRecordStore();\r\n        let user = reactive(group.getGroup(90000));\r\n        let unread = ref(0);\r\n        //触摸事件\r\n        function toggleClass(){\r\n            active.value = true;\r\n        }\r\n        //跳转到聊天界面\r\n        const router = useRouter();\r\n        function jump(){\r\n            router.push({\r\n                name:'MoricChatInterface',\r\n                query:{\r\n                    chat_name:user.username,\r\n                    chat_id:user.user_id\r\n                }\r\n            });\r\n        };\r\n        //创建聊天历史仓库\r\n        //跳转到这个页面时候主动获取最后一条消息\r\n        Promise.resolve(ChatRecordList.createChatList(user.user_id)).then(()=>{\r\n            const arr = ChatRecordList.getChatRecordLastMessage(user.user_id);\r\n            if(arr){\r\n                user.lastMsg = arr.messageData;\r\n                user.timing = arr.timeing;\r\n            }\r\n        });\r\n        //未读消息，被动接收消息\r\n        PubSub.subscribe(`${user.user_id}`,( _ , updatedMsg)=>{\r\n            //未读消息+1\r\n            unread.value ++;\r\n            //更新最后一条消息\r\n            user.lastMsg = updatedMsg.messageData;\r\n            //更新最后更新的时间\r\n            user.timing = updatedMsg.timeing;\r\n        });\r\n        //已读，未读消息清零\r\n        PubSub.subscribe(`${user.user_id}readed`,()=>{\r\n            unread.value = 0;\r\n        });\r\n\r\n        return{\r\n            unread,\r\n            user,\r\n            active,\r\n            toggleClass,\r\n            jump\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n    .MoricUserListItem{\r\n        width: 100%;\r\n        /* height: 40pt; */\r\n        padding: 12px 24px;\r\n        display: grid;\r\n        grid-template-columns: 40pt 1fr;\r\n        grid-template-rows: 1fr;\r\n        cursor: pointer;\r\n        position: relative;\r\n        border-bottom: solid 1px #e7e6eb;\r\n        /* box-shadow: 0 2px 1px #e7e6eb; */\r\n    }\r\n    .MoricUserListItem::after{\r\n        content: \"\";\r\n        position: absolute;\r\n        top: 10px;\r\n        left: 5px;\r\n        font-size: 12pt;\r\n    }\r\n    .MoricUserListItem:active{\r\n        background: #f0eff2;\r\n    }\r\n    .active{\r\n        background: #f0eff2;\r\n    }\r\n    @media(min-width: 600pt){\r\n        .MoricUserListItem:hover{\r\n            background: #f0eff2;\r\n        }\r\n        .MoricUserListItem:active{\r\n            background:none;\r\n        }\r\n    }\r\n    .avatar{\r\n        width: 40pt;\r\n        height: 40pt;\r\n        border-radius: 50%;\r\n        overflow: hidden;\r\n        position: relative;\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        font-size: 21pt;\r\n        color: #ffffff;\r\n        background: #167efd;\r\n    }\r\n    .avatarImage{\r\n        width: 100%;\r\n        height: 100%;\r\n        border-radius: 50%;\r\n        object-fit: cover;\r\n    }\r\n    .establishChat{\r\n        width: 100%;\r\n        height: 100%;\r\n        display: grid;\r\n        grid-template-columns: 1fr 30pt;\r\n        /* margin-left: 10pt; */\r\n    }\r\n    .establishChat_left{\r\n        display: flex;\r\n        padding: 0 0 0 10px;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        overflow: hidden;\r\n    }\r\n    .establishChat_left div{\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n    }\r\n    .userName{\r\n        font-size: 16pt;\r\n    }\r\n    .establishChat_right{\r\n        text-align: right;\r\n        display: grid;\r\n    }\r\n    .msgData{\r\n        margin-top: 2px;\r\n        font-size: 10pt;\r\n        font-weight: 400;\r\n        color: #8f8e93;\r\n    }\r\n    .msgDeta{\r\n        font-size: 10pt;\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n    .unread{\r\n        font-size: 10pt;\r\n        width: 100%;\r\n        height: 100%;\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        align-items: center;\r\n    }\r\n    .unreadData{\r\n        font-style: normal;\r\n        width: 12pt;\r\n        height: 12pt;\r\n        display: flex;\r\n        font-size: 8pt;\r\n        justify-content: center;\r\n        align-items: center;\r\n        border-radius: 50%;\r\n        padding: 5px;\r\n        background: #fc3d39;\r\n        color: #ffffff;\r\n    }\r\n    .loading{\r\n        background: linear-gradient(110deg,\r\n        rgba(255,255,255, 0) 40%,\r\n        rgba(255,255,255,.5) 50%,\r\n        rgba(255,255,255,0) 60%) #d9d9d9;\r\n        background-size: 200% 100%;\r\n        background-position-x: 120%;\r\n        overflow: hidden;\r\n        animation: 1s loading ease-in-out infinite;\r\n    }\r\n    @keyframes loading{\r\n        to{\r\n            background-position-x: -20%;\r\n        }\r\n    }\r\n</style>","import { render } from \"./MoricGroupItem.vue?vue&type=template&id=4be94882&scoped=true\"\nimport script from \"./MoricGroupItem.vue?vue&type=script&lang=js\"\nexport * from \"./MoricGroupItem.vue?vue&type=script&lang=js\"\n\nimport \"./MoricGroupItem.vue?vue&type=style&index=0&id=4be94882&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4be94882\"]])\n\nexport default __exports__","const distance = 50;\r\n\r\nexport default {\r\n    async mounted(el) {\r\n      let index = Number(el.getAttribute(\"index\")) + 1;\r\n      if (index % 2 == 0) {\r\n        await animateOne(el);\r\n      } else {\r\n        await animateTwo(el);\r\n      }\r\n    },\r\n};\r\n\r\nasync function animateOne(el) {\r\n    await el.animate([{\r\n        opacity: 0,\r\n        transform: `translate(-${distance}px,${distance}px)`,\r\n    },{\r\n        opacity: 1,\r\n        transform: `translate(0,0)`,\r\n    }],{\r\n        duration: 500,\r\n        easing: \"linear\",\r\n        fill: \"both\",\r\n    }).finished;\r\n}\r\n  \r\nasync function animateTwo(el) {\r\n    await el.animate([{\r\n        opacity: 0,\r\n        transform: `translate(${distance}px,${distance}px)`,\r\n    },{\r\n        opacity: 1,\r\n        transform: `translate(0,0)`,\r\n    }],{\r\n        duration: 500,\r\n        easing: \"linear\",\r\n        fill: \"both\",\r\n    }).finished;\r\n}","import { render } from \"./MoricUserList.vue?vue&type=template&id=69f09abe\"\nimport script from \"./MoricUserList.vue?vue&type=script&lang=js\"\nexport * from \"./MoricUserList.vue?vue&type=script&lang=js\"\n\nimport \"./MoricUserList.vue?vue&type=style&index=0&id=69f09abe&lang=css\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["useimgCounterStore","defineStore","state","imageList","Map","actions","async","user_id","avatar_type","this","has","getPicture","Promise","resolve","reject","axios","url","method","data","then","values","body","savePicture","catch","err","console","log","imgData","blob","test","byteCharacters","atob","split","byteNumbers","Array","length","i","charCodeAt","Blob","Uint8Array","type","set","imageUrl","get","window","URL","createObjectURL","clearImages","entries","revokeObjectURL","delete","class","_createElementVNode","_hoisted_3","_createElementBlock","_hoisted_1","_hoisted_2","onClick","_cache","_withModifiers","args","$setup","goTo","_hoisted_5","_toDisplayString","$props","name","_hoisted_6","props","setup","router","useRouter","chatRecordList","useChatRecordCounterStore","userList","useCounterStore","clearUserList","$reset","pubsub","replace","msg","path","__exports__","render","_createVNode","_component_MoricAppNavation","homeMsg","_component_MoricSearchInput","_component_MoricGroupItem","userListArray","_Fragment","key","_renderList","user","index","_component_MoricUserListItem","item","_normalizeClass","active","toggleClass","jump","imgNode","src","alt","_hoisted_4","_hoisted_7","lastMsg","_hoisted_8","_hoisted_9","timing","_hoisted_10","unreadMessage","_hoisted_11","ChatRecordList","reactive","ref","imgStore","requestImage","value","push","query","chat_name","chat_id","username","createChatList","arr","getChatRecordLastMessage","messageData","timeing","PubSub","subscribe","_","updatedMsg","title","placeholder","unread","group","useGroupChatRecordStore","getGroup","distance","el","Number","getAttribute","animateOne","animateTwo","animate","opacity","transform","duration","easing","fill","finished","components","MoricAppNavation","MoricUserListItem","MoricSearchInput","MoricGroupItem","mySelfLoaded","userStore","computed","directives","animateDirective"],"sourceRoot":""}